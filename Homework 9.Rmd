---
title: "Linear Regression"
author: "Sydney Drake"
date: "`r Sys.Date()`"
output:
  github_document:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Loading the data

```{r loading data}

# load data
life_expectancy <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2023/2023-12-05/life_expectancy.csv')
```

## (Optional) Sneak Peak For Lecture

```{r optional}
# Scatterplot with line of best fit
plot(life_expectancy$Year[life_expectancy$Year > 1883],life_expectancy$LifeExpectancy[life_expectancy$Year > 1883], pch = 19, col = "grey", xlab = "Year of Birth", ylab = "Life Expectancy")
abline(lm(LifeExpectancy ~ Year, data = life_expectancy[life_expectancy$Year > 1883,]), lt = 1)
```

# Linear regression: Before 1883, after 1883

In 1883, Koch identified and isolated the *Vibrio cholerae* bacterium in pure culture, a discovery previously made by Filippo Pacini in 1854 but not widely recognized. Koch's findings provided the definitive scientific proof needed to firmly establish the germ theory for cholera and many other diseases and was the beginning of the modern medical era.

```{r regression}
# Linear regression years before 1883 (Koch's germ theory)
lm_b1883 <- lm(LifeExpectancy ~ Year, data = life_expectancy[life_expectancy$Year < 1883,])
summary(lm_b1883)

# Linear regression years after 1883 (Koch's germ theory)
lm_a1883 <- lm(LifeExpectancy ~ Year, data = life_expectancy[life_expectancy$Year > 1883,])
summary(lm_a1883)
```

# Scatterplot with line(s) of best fit

```{r scatterplot}
plot(life_expectancy$Year,life_expectancy$LifeExpectancy, pch = 19, col = "grey", xlab = "Year of Birth", ylab = "Life Expectancy")
abline(lm_b1883, lt = 3)
abline(lm_a1883, lt = 1)
```

# Homework Questions:

## Q1. How significant is the linear relationship between life expectancy and year of birth?

-   What do the p-values in each model summary tell you about the statistical significance of the relationship?

    - The p-values show us the degree of correlation between the two factors; in this example, between the year of birth and the life expectancy of the individual. In other words, the smaller the p-value, the more confident we are that there is statistic significance in the relationship between the two values.

-   Compare across:

    (a) Before 1883
      - The linear relationship between birth year and life expectancy before 1883 was determined to be highly sigificant with a p-value of 5.33e-15.

    (b) After 1883
      - The linear relationship between birth year and life expectancy after 1883 is also highly significant with a p-value of 2e-16. This p-value is slightly smaller and thereby more significant that the p-value for birth years after 1883. Both, however, show a high correlation between the two variables.

*Hint: Look at the Pr(\>\|t\|) column for the Year variable in each summary() output.*

## Q2. What is the slope of the linear regression line in each model?

-   Report the estimated slope from the regression output (the coefficient for Year).

-   Interpret it: How much does life expectancy change per year of birth?

-   Compare across:

    (a) Before 1883
      - Before 1883, the slope of the linear regression is determined to be 0.025738. This means that every year, the life expectancy of individuals born in said year was estimated to be higher by 0.025738 years. This relationship is only significant and reliable before 1883

    (b) After 1883
      - After 1883, a different linear regression explains the relationship between birth year and life expectancy. The slope is determined to be 2.729e-01. Interpreted, this means that with each passing year after 1883, individuals born in said year were estimated to have a life expectancy 2.729e-01 years higher than the previous year. This slope is higher than the slope describing the correlation before 1883 by nearly tenfold, showing a dramatic improvement in life expectancy.

*Hint: A higher slope means faster improvement in life expectancy.*

## Q3. What might explain changes in the rate of increase in life expectancy through the years, especially before and after 1883?

While such a trend is affected by many factors, Robert Koch's discovery of the bacterium that causes cholera happened in 1883. The identification and eventually treatment of such a prevalent disease can greatly decrease fatalities that would otherwise bring the life expectancy of a population down.

Additionally, in this period, public opinion was rapidly changing and accepting the idea of germs. With this came an increased emphasis and attention on cleanliness. This has the potential to dramatically decrease the prevalence of disease and infection in society, which would thereby increase the life expectancy of individuals.

You can also refer to insights from the [Our World in Data](https://ourworldindata.org/life-expectancy?insight=life-expectancy-has-surpassed-predictions-again-and-again#key-insights) article on the topic.